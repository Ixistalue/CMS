<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>Розумна форма з валідацією</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #1e1e2f;
      color: #f0f0f0;
      padding: 40px;
      display: flex;
      justify-content: center;
    }

    form {
      background: #2c2c3c;
      padding: 30px 40px;
      border-radius: 16px;
      box-shadow: 0 0 30px rgba(0,0,0,0.2);
      width: 100%;
      max-width: 420px;
    }

    .form-group {
      margin-bottom: 30px;
      position: relative;
    }

    label {
      display: block;
      margin-bottom: 6px;
      font-weight: 600;
      color: #fff;
    }

    input {
      width: 100%;
      padding: 12px 14px;
      border: 2px solid #444;
      border-radius: 8px;
      font-size: 1rem;
      background-color: #1e1e2f;
      color: white;
      transition: border-color 0.3s;
    }

    input:focus {
      outline: none;
      border-color: #00aaff;
    }

    input.success {
      border-color: #27ae60;
    }

    input.error {
      border-color: #e74c3c;
    }

    .icon {
      position: absolute;
      right: 10px;
      top: 42px;
      font-size: 1.2rem;
      pointer-events: none;
    }

    .icon.success {
      color: #2ecc71;
    }

    .icon.error {
      color: #e74c3c;
    }

    .tooltip {
      position: absolute;
      left: 0;
      bottom: -28px;
      background: #e74c3c;
      color: white;
      padding: 6px 10px;
      border-radius: 6px;
      font-size: 0.85rem;
      opacity: 0;
      transition: opacity 0.4s ease;
      pointer-events: none;
    }

    .tooltip.show {
      opacity: 1;
    }

    button {
      width: 100%;
      padding: 14px;
      font-size: 1rem;
      border: none;
      border-radius: 8px;
      background-color: #00aaff;
      color: white;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    button:hover {
      background-color: #0077cc;
    }
  </style>
</head>
<body>
  <form id="smartForm" novalidate>
    <div class="form-group">
      <label for="name">Ім’я</label>
      <input type="text" id="name" required minlength="3">
      <div class="icon" id="nameIcon"></div>
      <div class="tooltip" id="nameError">Помилка</div>
    </div>

    <div class="form-group">
      <label for="email">Email</label>
      <input type="email" id="email" required>
      <div class="icon" id="emailIcon"></div>
      <div class="tooltip" id="emailError">Помилка</div>
    </div>

    <div class="form-group">
      <label for="password">Пароль</label>
      <input type="password" id="password" required minlength="6">
      <div class="icon" id="passwordIcon"></div>
      <div class="tooltip" id="passwordError">Помилка</div>
    </div>

    <button type="submit">Надіслати</button>
  </form>

  <script>
    const form = document.getElementById("smartForm");
    const fields = [
      {
        id: "name",
        message: "Ім’я має містити щонайменше 3 символи"
      },
      {
        id: "email",
        message: "Введіть коректну адресу електронної пошти"
      },
      {
        id: "password",
        message: "Пароль має містити щонайменше 6 символів"
      }
    ];

    let debounceTimers = {};

    function validateField(input, tooltip, icon, message) {
      if (!input.checkValidity()) {
        input.classList.remove("success");
        input.classList.add("error");
        tooltip.textContent = message;
        tooltip.classList.add("show");
        icon.textContent = "❌";
        icon.classList.add("error");
        icon.classList.remove("success");
      } else {
        input.classList.remove("error");
        input.classList.add("success");
        tooltip.classList.remove("show");
        icon.textContent = "✅";
        icon.classList.add("success");
        icon.classList.remove("error");
      }
    }

    fields.forEach(({ id, message }) => {
      const input = document.getElementById(id);
      const tooltip = document.getElementById(id + "Error");
      const icon = document.getElementById(id + "Icon");

      input.addEventListener("blur", () => {
        validateField(input, tooltip, icon, message);
      });

      // debounce при вводі — щоб не перевірялося кожну мілісекунду
      input.addEventListener("input", () => {
        clearTimeout(debounceTimers[id]);
        debounceTimers[id] = setTimeout(() => {
          if (input.value !== "") {
            validateField(input, tooltip, icon, message);
          }
        }, 400); // затримка 400 мс
      });
    });

    form.addEventListener("submit", (e) => {
      e.preventDefault();
      let isValid = true;
      fields.forEach(({ id, message }) => {
        const input = document.getElementById(id);
        const tooltip = document.getElementById(id + "Error");
        const icon = document.getElementById(id + "Icon");
        validateField(input, tooltip, icon, message);
        if (!input.checkValidity()) isValid = false;
      });
      if (isValid) {
        alert("Успішно надіслано!");
        form.reset();
        document.querySelectorAll(".tooltip").forEach(t => t.classList.remove("show"));
        document.querySelectorAll(".icon").forEach(i => i.textContent = "");
        document.querySelectorAll("input").forEach(i => i.classList.remove("success"));
      }
    });
  </script>
</body>
</html>
